#include <stdio.h>
#include <string.h>
#include <stdlib.h>

int main()
{
	FILE *file;
	file = fopen("flag.txt", "rb");
	if(!file)
	{
		printf("flag.txt not found!!\n");
		return 0;
	}
	char c[6] = "";
	char x[] = "flag{";
	char m[6] = "";

	fread(&c, 1, 5, file);
	
	for(int i = 0; i<=0xFFFF; i++)
	{
		srand(i);
		for(int j = 0; j<5; j++)
		{
			m[j] = c[j] ^ rand();
		}
		if(strncmp(m,x,strlen(x))==0)
		{
			char l;
			printf("flag{");
			while(fread(&l, 1, 1, file))
				printf("%c", l^rand());
			printf("\n");
			break;
		}
	}
	fclose(file);
	return 0;
}
